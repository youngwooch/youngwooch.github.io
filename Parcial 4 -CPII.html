<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 7.4.2.3 (Linux)"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changed" content="00:00:00"/>
	<style type="text/css">
		@page { size: 8.5in 11in; margin: 0.79in }
		p { line-height: 115%; margin-bottom: 0.1in; background: transparent }
		pre { font-family: "Liberation Mono", monospace; font-size: 10pt; background: transparent }
	</style>
</head>
<body lang="en-US" link="#000080" vlink="#800000" dir="ltr"><pre>---
title: &quot;Parcial 4 - CPII&quot;
format: html
editor: visual
author: Claire Valeria Calder√≥n Zavaleta y Young Woo Choi
---

## Parcial 4 - CPII

### Librer√≠as

Para el proyecto que se desdarrollar√° en este sitio, haremos uso de las siguientes librer√≠as; adem√°s, fijamos la semilla con la que estuvimos trabajando durante el desarrollo de este proyecto.

```{r}
library(dplyr)
library(ggplot2)
library(patchwork)
library(fitdistrplus)
```

### Ejercicio 1

Considere X~1~, X~2~, \... , X~n~ variables aleatorias independientes e id√©nticamente distribuidas, todas con distribuci√≥n exponencial con media 5. Tambi√©n considere Y~1~, Y~2~, \... , Y~m~ variables aleatorias independientes e id√©nticamente distribuidas todas con distribuci√≥n exponencial con media 15 e independientes de los X~i~s. Defina la cantidad

$T=\frac{\frac{1}{n}\sum_{i=1}^{n}X_{i}}{\frac{1}{m}\sum_{j=1}^{m}Y_{j}}$

\(a\) Tome m = 20. Simule n = 10, 100, 1,000, 10,000 X~i~s y Y~j~s y sugiera una posible distribuci√≥n.

```{r}
#Definimos nuestras lambdas
lambda1 &lt;- 5
lambda2 &lt;- 15

simulaciones &lt;- function(n,m){
  X&lt;-rexp(n, rate = 1/lambda1)
  Y&lt;-rexp(m, rate = 1/lambda2)
  PromX &lt;- mean(X)
  PromY &lt;- mean(Y)
  resultado &lt;- PromX/PromY
  return(resultado)
}

n10 &lt;- replicate(1000, simulaciones(10,20))
df_simuls_n10 &lt;- data.frame(simulaciones = n10)
densidadn10 &lt;- df_simuls_n10 %&gt;% ggplot() +
  geom_density(aes(x = n10), color = &quot;#FF0000&quot;, size = 1) +
  theme_minimal()

n100 &lt;- replicate(1000, simulaciones(100,20))
df_simuls_n100 &lt;- data.frame(simulaciones = n100)
densidadn100 &lt;- df_simuls_n100 %&gt;% ggplot() +
  geom_density(aes(x = n100), color = &quot;#FF0033&quot;, size = 1) +
  theme_minimal()

n1000 &lt;- replicate(1000, simulaciones(1000,20))
df_simuls_n1000 &lt;- data.frame(simulaciones = n1000)
densidadn1000 &lt;- df_simuls_n1000 %&gt;% ggplot() +
  geom_density(aes(x = n1000), color = &quot;#CC0000&quot;, size = 1) +
  theme_minimal()

n10000 &lt;- replicate(1000, simulaciones(1000,20))
df_simuls_n10000 &lt;- data.frame(simulaciones = n1000)
densidadn10000 &lt;- df_simuls_n1000 %&gt;% ggplot() +
  geom_density(aes(x = n1000), color = &quot;#FF6633&quot;, size = 1) +
  theme_minimal()

(densidadn10 | densidadn100) / (densidadn1000 | densidadn10000)
```

**Respuesta:** De acuerdo con las gr√°ficas observadas, sugerimos que corresponden a una distribuci√≥n Gamma.

\(b\) Tome n = 20. Simule m = 10, 100, 1,000, 10,000 X~i~s y Y~j~s y sugiera una posible distribuci√≥n.

```{r}
m10 &lt;- replicate(1000, simulaciones(20,10))
df_simuls_m10 &lt;- data.frame(simulaciones = m10)
densidadm10 &lt;- df_simuls_m10 %&gt;% ggplot() +
  geom_density(aes(x = m10), color = &quot;#6600FF&quot;, size = 1) +
  theme_minimal()

m100 &lt;- replicate(1000, simulaciones(20,100))
df_simuls_m100 &lt;- data.frame(simulaciones = m100)
densidadm100 &lt;- df_simuls_m100 %&gt;% ggplot() +
  geom_density(aes(x = m100), color = &quot;#9900CC&quot;, size = 1) +
  theme_minimal()

m1000 &lt;- replicate(1000, simulaciones(20,1000))
df_simuls_m1000 &lt;- data.frame(simulaciones = m1000)
densidadm1000 &lt;- df_simuls_m1000 %&gt;% ggplot() +
  geom_density(aes(x = m1000), color = &quot;#663399&quot;, size = 1) +
  theme_minimal()

m10000 &lt;- replicate(1000, simulaciones(20,1000))
df_simuls_m10000 &lt;- data.frame(simulaciones = m10000)
densidadm10000 &lt;- df_simuls_m10000 %&gt;% ggplot() +
  geom_density(aes(x = m10000), color = &quot;#6633CC&quot;, size = 1) +
  theme_minimal()

(densidadm10 | densidadm100) / (densidadm1000 | densidadm10000)
```

**Respuesta:** De acuerdo con las gr√°ficas observadas, intuimos que se trata de una distribuci√≥n Gamma.

\(c\) Encuentre la distribuci√≥n de T

**Respuesta:** Dado que en los incisos a) y b) determinamos que se tratan de Gammas, conclu√≠mos que T tiene distribuci√≥n Gamma.

### Ejercicio 2

Considere X~1~, X~2~, \... , X~n~ variables aleatorias independientes e id√©nticamente distribuidas, todas con distribuci√≥n normal est√°ndar. Defina

$U = \frac{\sqrt{n} X_{1}+X_{2}+ . . . + X_{n}}{X_{1}^{2}+X_{2}^{2}+ . . . + X_{n}^{2}}$

Haga n = 10, 100, 1000, 10000 simulaciones de U y sugiera una posible distribuci√≥n para U

```{r}
simulacionesU &lt;- function(n){
  X &lt;- sum(rnorm(n, mean = 0, sd = 1))
  Y &lt;- sum(rnorm(n, mean = 0, sd = 1)^2)
  U &lt;- (sqrt(n)*X)/Y
  return(U)
}
U10 &lt;- replicate(1000, simulacionesU(10))
U100 &lt;- replicate(1000, simulacionesU(100))
U1000 &lt;- replicate(1000, simulacionesU(1000))
U10000 &lt;- replicate(1000, simulacionesU(10000))

df_simuls_U10 &lt;- data.frame(simulaciones = U10)
densidadU10 &lt;- df_simuls_U10 %&gt;% ggplot() +
  geom_density(aes(x = U10), color = &quot;#00FF00&quot;, size = 1) +
  theme_minimal()

df_simuls_U100 &lt;- data.frame(simulaciones = U100)
densidadU100 &lt;- df_simuls_U100 %&gt;% ggplot() +
  geom_density(aes(x = U100), color = &quot;#99FF33&quot;, size = 1) +
  theme_minimal()

df_simuls_U1000 &lt;- data.frame(simulaciones = U1000)
densidadU1000 &lt;- df_simuls_U10 %&gt;% ggplot() +
  geom_density(aes(x = U1000), color = &quot;#00FF66&quot;, size = 1) +
  theme_minimal()

df_simuls_U10000 &lt;- data.frame(simulaciones = U10000)
densidadU10000 &lt;- df_simuls_U10000 %&gt;% ggplot() +
  geom_density(aes(x = U10000), color = &quot;#00CC33&quot;, size = 1) +
  theme_minimal()

(densidadU10 | densidadU100) / (densidadU1000 | densidadU10000)
```

**Respuesta:** De acuerdo con las gr√°ficas observadas, sugerimos que U tiene una distribuvi√≥n T de Student.

### Ejercicio 3

Considere X~1~, X~2~, \... , X~n~ variables aleatorias independientes e id√©nticamente distribuidas, todas con distribuci√≥n Unif(0,5). Defina

\$ U = \\max { (X\_{1}+X\_{2}+ . . . + X\_{n})} - 5\$

Haga n = 10, 100, 1000, 10000 simulaciones de U y sugiera una posible distribuci√≥n para U

```{r}
library(dplyr)
library(ggplot2)
library(patchwork)
a &lt;- 0
b &lt;- 5
esp &lt;- (a + b)/2
var &lt;- ((b-a)**2)/12
## n = 10
n10 &lt;- 10
simulaciones &lt;- replicate(n, {
  U &lt;- max(runif(n10, min = a, max = b)) - 5
  (U - esp) / sqrt(var/n)
})
df_simuls &lt;- data.frame(simulaciones = simulaciones)
densidad3_1 &lt;- df_simuls %&gt;% ggplot() +
  geom_density(aes(x = simulaciones), color = &quot;#00CCCC&quot;, size = 1) +
  theme_minimal()

## n = 100
n10 &lt;- 100
simulaciones &lt;- replicate(n, {
  U &lt;- max(runif(n100, min = a, max = b)) - 5
  (U - esp) / sqrt(var/n)
})
df_simuls &lt;- data.frame(simulaciones = simulaciones)
densidad3_2 &lt;- df_simuls %&gt;% ggplot() +
  geom_density(aes(x = simulaciones), color = &quot;#33CC99&quot;, size = 1) +
  theme_minimal()

## n = 1000
n10 &lt;- 1000
simulaciones &lt;- replicate(n, {
  U &lt;- max(runif(n1000, min = a, max = b)) - 5
  (U - esp) / sqrt(var/n)
})
df_simuls &lt;- data.frame(simulaciones = simulaciones)
densidad3_3 &lt;- df_simuls %&gt;% ggplot() +
  geom_density(aes(x = simulaciones), color = &quot;#009999&quot;, size = 1) +
  theme_minimal()

## n = 10000
n10 &lt;- 10000
simulaciones &lt;- replicate(n, {
  U &lt;- max(runif(n10000, min = a, max = b)) - 5
  (U - esp) / sqrt(var/n)
})
df_simuls &lt;- data.frame(simulaciones = simulaciones)
densidad3_4 &lt;- df_simuls %&gt;% ggplot() +
  geom_density(aes(x = simulaciones), color = &quot;#669999&quot;, size = 1) +
  theme_minimal()

(densidad3_1 | densidad3_2) / (densidad3_3 | densidad3_4)
```

**Respuesta:** De acuerdo con las gr√°ficas observadas, conclu√≠mos que U podr√≠a tener una distribuci√≥n Beta.

### Ejercicio 4

Se lanzan 3 dados balanceados. Sea X la suma de las caras.

\(a\) Para n = 100, 1,000, 10,000, 100,000 haga n simulaciones para obtener la funci√≥n de masa de probabilidad aproximada de X.

```{r}
caras &lt;- 1:6
num_dados &lt;- 3
### n = 100
n = 100
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = caras, size = num_dados, replace = TRUE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(suma = vector_simuls)
head(df)
grafica4_1 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = suma,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#99CCFF&quot;) +
  ggtitle(&quot;Densidad de la suma n=100&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Suma&quot;) + theme_light()
### n = 1000
n = 1000
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = caras, size = num_dados, replace = TRUE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(suma = vector_simuls)
head(df)
grafica4_2 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = suma,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#33CC99&quot;) +
  ggtitle(&quot;Densidad de la suma n=1000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Suma&quot;) + theme_light()
### n = 10000
n = 10000
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = caras, size = num_dados, replace = TRUE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(suma = vector_simuls)
head(df)
grafica4_3 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = suma,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#FFCC00&quot;) +
  ggtitle(&quot;Densidad de la suma n=100000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Suma&quot;) + theme_light()
### n = 100000
n = 100000
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = caras, size = num_dados, replace = TRUE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(suma = vector_simuls)
head(df)
grafica4_4 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = suma,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#FF0033&quot;) +
  ggtitle(&quot;Densidad de la suma n=10000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Suma&quot;) + theme_light()
```

\(b\) Usando las funciones de las librer√≠a 'patchwork' y 'ggplot2' ponga en un mismo gr√°fico las cuatro gr√°ficas de las funciones de masa del inicio anterior.

```{r}
(grafica4_1 | grafica4_2) / (grafica4_3 | grafica4_4)
```

**Respuesta:** De acuerdo con lo visto en los gr√°ficos, sugerimos que las simulaciones podr√≠an corresponder a una distribuci√≥n Poisson.

\(c\) Para n = 10, . . . , 100000 haga n simulaciones para obtener un estimado de la probabilidad IP(X ‚â§ 3). Ponga en un gr√°fico n en el eje horizontal y la probabilidad en el eje vertical.

```{r}
simuls_satisfacen &lt;- vector_simuls &lt;= 3
str(simuls_satisfacen)
i &lt;- 10
vector_simuls[1:i]
satisfacen &lt;- simuls_satisfacen[1:i]
satisfacen
proba_estimada &lt;- sum(satisfacen)/length(satisfacen)
proba_estimada
probabilidades_estimadas &lt;- c()
for(i in 10:length(simuls_satisfacen)){
  satisfacen &lt;- simuls_satisfacen[1:i]
  proba_estimada &lt;- sum(satisfacen)/length(satisfacen)
  probabilidades_estimadas &lt;- c(probabilidades_estimadas, proba_estimada)
}
df_probas &lt;- data.frame(n = 10:length(simuls_satisfacen),
                        probabilidades = probabilidades_estimadas)
df_probas %&gt;% tail()
df_probas %&gt;% ggplot() +
  geom_line(color = '#CC6600',aes(x = n, y = probabilidades)) +
  theme_light()
```

### Ejercicio 5

Una urna tiene 7 bolas numeradas del 1 al 7. Se sacan 2 bolas de la urna SIN reemplazo. Sea X la suma del n√∫meros en las bolas.

\(a\) Para n = 100, 1,000, 10,000, 100,000 haga n simulaciones para obtener la funci√≥n de masa de probabilidad aproximada de X.

```{r}
bolas &lt;- 1:7
num_bolas &lt;- 2
### n = 100
n = 100
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = bolas, size = num_bolas, replace = FALSE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(suma = vector_simuls)
head(df)
grafica5_1 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = suma,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#FF99FF&quot;) +
  ggtitle(&quot;Densidad de la suma n=100&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Suma&quot;) + theme_light()
### n = 1000
n = 1000
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = caras, size = num_dados, replace = FALSE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(suma = vector_simuls)
head(df)
grafica5_2 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = suma,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#FF66FF&quot;) +
  ggtitle(&quot;Densidad del producto n=1000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;producto&quot;) + theme_light()
### n = 10000
n = 10000
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = caras, size = num_dados, replace = FALSE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(suma = vector_simuls)
head(df)
grafica5_3 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = suma,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#CC3399&quot;) +
  ggtitle(&quot;Densidad de la suma n=10000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Suma&quot;) + theme_light()
### n = 100000
n = 100000
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = caras, size = num_dados, replace = FALSE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(suma = vector_simuls)
head(df)
grafica5_4 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = suma,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#660066&quot;) +
  ggtitle(&quot;Densidad de la suma n=100000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Suma&quot;) + theme_light()
```

\(b\) Usando las funciones de las librer√≠a 'patchwork' y 'ggplot2' ponga en un mismo gr√°fico las cuatro gr√°ficas de las funciones de masa del inicio anterior.

```{r}
(grafica5_1 | grafica5_2) / (grafica5_3 | grafica5_4)
```

**Respuesta:** De acuerdo con las gr√°ficas generadas, X parece tener distribuci√≥n Binomial.

\(c\) Para n = 10, . . . , 100,000 haga n simulaciones para obtener un estimado de la probabilidad IP(X ‚â§ 10). Ponga en un gr√°fico n en el eje horizontal y la probabilidad en el eje vertical.

```{r}
simuls_satisfacen &lt;- vector_simuls &lt;= 10
str(simuls_satisfacen)
i &lt;- 10
vector_simuls[1:i]
satisfacen &lt;- simuls_satisfacen[1:i]
satisfacen
proba_estimada &lt;- sum(satisfacen)/length(satisfacen)
proba_estimada
probabilidades_estimadas &lt;- c()
for(i in 10:length(simuls_satisfacen)){
  satisfacen &lt;- simuls_satisfacen[1:i]
  proba_estimada &lt;- sum(satisfacen)/length(satisfacen)
  probabilidades_estimadas &lt;- c(probabilidades_estimadas, proba_estimada)
}
df_probas &lt;- data.frame(n = 10:length(simuls_satisfacen),
                        probabilidades = probabilidades_estimadas)
df_probas %&gt;% tail()
df_probas %&gt;% ggplot() +
  geom_line(color = '#FF3366',aes(x = n, y = probabilidades)) +
  theme_light()
```

### Ejercicio 6

Una urna tiene 7 bolas numeradas del 1 al 7. Se sacan 2 bolas de la urna CON reemplazo. Sea X la suma del n√∫meros en las bolas.

\(a\) Para n = 100, 1,000, 10,000, 100,000 haga n simulaciones para obtener la funci√≥n de masa de probabilidad aproximada de X.

```{r}
bolas &lt;- 1:7
num_bolas &lt;- 2
### n = 100
n = 100
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = bolas, size = num_bolas, replace = TRUE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(suma = vector_simuls)
head(df)
grafica6_1 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = suma,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#FFCC66&quot;) +
  ggtitle(&quot;Densidad de la suma n=100&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Suma&quot;) + theme_light()
### n = 1000
n = 1000
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = caras, size = num_dados, replace = TRUE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(suma = vector_simuls)
head(df)
grafica6_2 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = suma,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#FFCC33&quot;) +
  ggtitle(&quot;Densidad de la suma n=1000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Suma&quot;) + theme_light()
### n = 10000
n = 10000
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = caras, size = num_dados, replace = TRUE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(suma = vector_simuls)
head(df)
grafica6_3 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = suma,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#FFCC00&quot;) +
  ggtitle(&quot;Densidad de la suma n=10000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Suma&quot;) + theme_light()
### n = 100000
n = 100000
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = caras, size = num_dados, replace = TRUE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(suma = vector_simuls)
head(df)
grafica6_4 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = suma,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#CC9900&quot;) +
  ggtitle(&quot;Densidad de la suma n=100000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Suma&quot;) + theme_light()
```

\(b\) Usando las funciones de las librer√≠as 'patchwork' y 'ggplot2' ponga en un mismo gr√°fico las cuatro gr√°ficas de las funciones de masa del inciso anterior.

```{r}
(grafica6_1 | grafica6_2) / (grafica6_3 | grafica6_4)
```

**Respuesta:** Conclu√≠mos que, de acuerdo con las gr√°ficas observadas, X tiene distribuci√≥n Binomial.

\(c\) Para n = 10, . . . , 100000 haga n simulaciones para obtener un estimado de la probabilidad IP(X ‚â§ 10). Ponga en un gr√°fico n en el eje horizontal y la probabilidad en el eje vertical.

```{r}
simuls_satisfacen &lt;- vector_simuls &lt;= 10
str(simuls_satisfacen)
i &lt;- 10
vector_simuls[1:i]
satisfacen &lt;- simuls_satisfacen[1:i]
satisfacen
proba_estimada &lt;- sum(satisfacen)/length(satisfacen)
proba_estimada
probabilidades_estimadas &lt;- c()
for(i in 10:length(simuls_satisfacen)){
  satisfacen &lt;- simuls_satisfacen[1:i]
  proba_estimada &lt;- sum(satisfacen)/length(satisfacen)
  probabilidades_estimadas &lt;- c(probabilidades_estimadas, proba_estimada)
}
df_probas &lt;- data.frame(n = 10:length(simuls_satisfacen),
                        probabilidades = probabilidades_estimadas)
df_probas %&gt;% tail()
df_probas %&gt;% ggplot() +
  geom_line(color = '#CC9933',aes(x = n, y = probabilidades)) +
  theme_light()
```

### Ejercicio 7

En un sal√≥n de clases del curso de C√°lculo de Probabilidad 2 hay 50 estudiantes. Cada estudiante pone en papel su clave √∫nica (CU) y lo introduce en una urna com√∫n. Posteriormente dichxs estudiantes toman un papel de la urna. Sea X el n√∫mero de alumnos que sacaron el papelito con su clave √∫nica.

\(a\) Para n = 100, 1,000, 10,000, 100,000 haga n simulaciones para obtener la funci√≥n de masa de probabilidad aproximada de X.

```{r}
claves &lt;- 1:50
num_claves &lt;- 1
### n = 100
n = 100
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = claves, size = num_claves, replace = FALSE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(cuenta = vector_simuls)
head(df)
grafica7_1 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = cuenta,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#66CC00&quot;) +
  ggtitle(&quot;Densidad del num de estudiantes n=100&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Estudiantes&quot;) + theme_light()
### n = 1000
n = 1000
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = claves, size = num_claves, replace = FALSE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(cuenta = vector_simuls)
head(df)
grafica7_2 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = cuenta,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#66CC33&quot;) +
  ggtitle(&quot;Densidad del num de estudiantes n=1000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Estudiantes&quot;) + theme_light()
### n = 10000
n = 10000
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = claves, size = num_claves, replace = FALSE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(cuenta = vector_simuls)
head(df)
grafica7_3 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = cuenta,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#99CC00&quot;) +
  ggtitle(&quot;Densidad del num de estudiantes n=10000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Estudiantes&quot;) + theme_light()
### n = 100000
n = 100000
num_sim &lt;- n
vector_simuls &lt;- c()
for(i in 1:num_sim){
  simulacion &lt;- sample(x = claves, size = num_claves, replace = FALSE)
  valor_simulacion &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_simulacion)
}
df &lt;- data.frame(cuenta = vector_simuls)
head(df)
grafica7_4 &lt;- df %&gt;% ggplot() +
  geom_histogram(aes(x = cuenta,
                     y=..count../sum(..count..)),linewidth=1, fill = &quot;#00CC33&quot;) +
  ggtitle(&quot;Densidad del num de estudiantes n=100000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Estudiantes&quot;) + theme_light()
```

\(b\) Usando las funciones de las librer¬¥ƒ±a 'patchwork' y 'ggplot2' ponga en un mismo gr√°fico las cuatro gr√°ficas de las funciones de masa del inicio anterior.

```{r}
(grafica7_1 | grafica7_2) / (grafica7_3 | grafica7_4)
```

**Respuesta:** Nos result√≥ dif√≠cil determinar una densidad para dicha variable, debido a que la gr√°fica es irregular. Posiblemente, se trate de una multinomial.

(c) Para n = 10, . . . , 100,000 haga n simulaciones para obtener un estimado de la probabilidad IP(X ‚â§ 15). Ponga en un gr√°fico n en el eje horizontal y la probabilidad en el eje vertical.

```{r}
simuls_satisfacen &lt;- vector_simuls &lt;= 15
str(simuls_satisfacen)
i &lt;- 10
vector_simuls[1:i]
satisfacen &lt;- simuls_satisfacen[1:i]
satisfacen
proba_estimada &lt;- sum(satisfacen)/length(satisfacen)
proba_estimada
probabilidades_estimadas &lt;- c()
for(i in 10:length(simuls_satisfacen)){
  satisfacen &lt;- simuls_satisfacen[1:i]
  proba_estimada &lt;- sum(satisfacen)/length(satisfacen)
  probabilidades_estimadas &lt;- c(probabilidades_estimadas, proba_estimada)
}
df_probas &lt;- data.frame(n = 10:length(simuls_satisfacen),
                        probabilidades = probabilidades_estimadas)
df_probas %&gt;% tail()
df_probas %&gt;% ggplot() +
  geom_line(color = &quot;#006600&quot;,aes(x = n, y = probabilidades)) +
  theme_light()
```

### Ejercicio 8

Simule tantos n√∫meros uniformes en el intervalo (0,1) hasta que su suma sea mayor o igual que 1. Sea N el n√∫mero de sumandos requeridos para alcanzar dicho objetivo. Por ejemplo si obtuvo los n√∫meros 0.35, 0.58, 0.22 se tiene que N = 3 (pues se necesit√≥ 3 sumandos para que la suma sea mayor √≥ igual que 1).

\(a\) Para n = 100, 1,000, 10,000, 100,000 haga 10,000 simulaciones para obtener la funci√≥n de masa de probabilidad aproximada de N.

```{r}
suma_unif &lt;- function() {
  suma &lt;- 0
  n &lt;- 0
  while (suma &lt; 1) {
    suma &lt;- suma + runif(1)
    n &lt;- n + 1
  }
  return(n)
}
valores &lt;- c(100, 1000, 10000, 100000)

densidad &lt;- lapply(valores, function(n) {
  N &lt;- replicate(n, suma_unif())
  den &lt;- frecuencia_relativa(N)
  return(den)
})

grafica_den &lt;- function(pmf, n) {
  df &lt;- data.frame(x = as.numeric(names(pmf)), y = as.vector(pmf))
  ggplot(df, aes(x = x, y = y)) +
    geom_bar(stat = &quot;identity&quot;, fill = &quot;#666699&quot;) +
    ggtitle(paste(&quot;Funci√≥n de masa de probabilidad para n =&quot;, n)) +
    xlab(&quot;X&quot;) +
    ylab(&quot;Probabilidad&quot;) +
    theme_minimal()
}
grafica8 &lt;- mapply(grafica_den, densidad, valores, SIMPLIFY = FALSE)
```

\(b\) Usando las funciones de las librer¬¥ƒ±a 'patchwork' y 'ggplot2' ponga en un mismo gr√°fico las cuatro gr√°ficas de las funciones de masa del inicio anterior.

```{r}
(grafica8[[1]] / grafica8[[2]]) | (grafica8[[3]] / grafica8[[4]])
```

(c) Para n = 10, . . . , 100000 haga n simulaciones para obtener un estimado del valor esperado de ùîº(X). Ponga en un gr√°fico n en el eje horizontal y el valor esperado en el eje vertical.

```{r}
valores_nvo &lt;- 10:10000
esp_n &lt;- sapply(valores_nvo, function(n) {
  N &lt;- replicate(n, suma_unif())
  esp_n &lt;- mean(N)
  return(esp_n)
})

grafica_esp &lt;- ggplot(data.frame(n = valores_nvo, valor_esp = esp_n), aes(x = n, y = valor_esp)) +
  geom_line(color = &quot;#330066&quot;) +
  ggtitle(&quot;Valor esperado estimado de E(N)&quot;) +
  xlab(&quot;n&quot;) +
  ylab(&quot;Valor esperado&quot;) +
  theme_minimal()
grafica_esp
```

### Ejercicio 9

Considere X~1~, . . . , X~n~ variables aleatorias independientes e id√©nticamente distribuidas, X~i~ ‚àº Unif(0, 1). Sea X~(2)~ el segundo valor mas de peque√±o de estas n X~i~'s

\(a\) Para n = 100, 1,000, 10,000, 100,000 haga n simulaciones para obtener la funci√≥n de masa de probabilidad aproximada de X~(2)~

```{r}
a &lt;- 0
b &lt;- 1
esp &lt;- (a + b)/2
var &lt;- ((b-a)**2)/12
## n = 100
n &lt;- 100
simulaciones &lt;- c()
for(i in 2:n){  
  simulaciones &lt;- replicate(n, {
    U &lt;- sort(runif(n, min = a, max = b))[2]
    (U - esp) / sqrt(var/n)
  })
}
df_simuls &lt;- data.frame(simulaciones = simulaciones)
densidad9_1 &lt;- df_simuls %&gt;% ggplot() +
  geom_density(aes(x = simulaciones), color = &quot;#0000FF&quot;, size = 1) +
  ggtitle(&quot;Densidad del X(2), con n=100&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Densidad&quot;) + theme_light()
## n = 1000
n &lt;- 1000
simulaciones &lt;- c()
simulaciones &lt;- replicate(n, {
  U &lt;- sort(runif(n, min = a, max = b))[2]
  (U - esp) / sqrt(var/n)
})

df_simuls &lt;- data.frame(simulaciones = simulaciones)
densidad9_2 &lt;- df_simuls %&gt;% ggplot() +
  geom_density(aes(x = simulaciones), color = &quot;#3300FF&quot;, size = 1) +
  ggtitle(&quot;Densidad del X(2), con n=1000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Densidad&quot;) + theme_light()
## n = 10000
n &lt;- 10000
simulaciones &lt;- c()
simulaciones &lt;- replicate(n, {
  U &lt;- sort(runif(n, min = a, max = b))[2]
  (U - esp) / sqrt(var/n)
})

df_simuls &lt;- data.frame(simulaciones = simulaciones)
densidad9_3 &lt;- df_simuls %&gt;% ggplot() +
  geom_density(aes(x = simulaciones), color = &quot;#0000CC&quot;, size = 1) +
  ggtitle(&quot;Densidad del X(2), con n=10000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Densidad&quot;) + theme_light()
## n = 100000
n &lt;- 100000
simulaciones &lt;- c()
simulaciones &lt;- replicate(n, {
  U &lt;- sort(runif(n, min = a, max = b))[2]
  (U - esp) / sqrt(var/n)
})

df_simuls &lt;- data.frame(simulaciones = simulaciones)
densidad9_4 &lt;- df_simuls %&gt;% ggplot() +
  geom_density(aes(x = simulaciones), color = &quot;#330099&quot;, size = 1) +
  ggtitle(&quot;Densidad del X(2), con n=100000&quot;) +
  ylab(&quot;f&quot;) + xlab(&quot;Densidad&quot;) + theme_light()
```

\(b\) Usando las funciones de las librer√≠a 'patchwork' ponga en un mismo gr√°fico las cuatro gr√°ficas de las funciones de masa del inciso (a).

```{r}
(densidad9_1 | densidad9_2) / (densidad9_3 | densidad9_4)
```

\(c\) ¬øQu√© densidad dir√≠a que tiene X~(2)~?

**Respuesta:** Por lo que se puede observar en las gr√°ficas, dir√≠amos que la densidad de X~(2)~ corresponde a una distribuci√≥n Beta.

\(d\) ¬øEs consistente este resultado con el ejemplo te√≥rico que se vio en clase?

**Respuesta:** En clase se vio que la j-√©sima estad√≠stica de orden de n variables aleatorias independientes e id√©nticamente distribuidas de forma Unif(0,1) se distribuye de manera Beta(j, n-j+1). Por lo tanto, la segunda estad√≠stica de orden, seg√∫n lo que vimos, deber√≠a seguir una distribuci√≥n Beta(2, n-2+1) i.e. Beta(2, n-1). Por lo tanto, s√≠ corresponden ambos resultados.

### Ejercicio 10

Considere X~1~, . . . , X~n~ variables aleatorias independientes e id√©nticamente distribuidas, X~i~ ‚àº Unif(0, 1). Sea X~med~ el segundo valor mas de peque√±o de estas n X~i~'s

\(a\) Para n = 100, 1,000, 10,000, 100,000 haga 10000 simulaciones para obtener la funci√≥n de masa de probabilidad aproximada de X~med~.

```{r}
## n = 100
n &lt;- 100 
N &lt;- 10000

med100 &lt;- replicate(N, median(runif(n, -1, 1)))
dens100 &lt;- density(med100)

## n = 1000
n &lt;- 1000 
N &lt;- 10000

med1000 &lt;- replicate(N, median(runif(n, -1, 1)))
dens1000 &lt;- density(med1000)

## n = 10000
n &lt;- 10000
N &lt;- 10000

med10000 &lt;- replicate(N, median(runif(n, -1, 1)))
dens10000 &lt;- density(med10000)

## n = 100000
n &lt;- 100000 
N &lt;- 10000

med100000 &lt;- replicate(N, median(runif(n, -1, 1)))
dens100000 &lt;- density(med100000)
```

\(b\) Usando las funciones de las librer√≠a 'patchwork' ponga en un mismo gr√°fico las cuatro gr√°ficas de las funciones de masa del inciso (a).

```{r}
par(mfrow = c(2, 2))
plot(dens100, main = paste0(&quot;n = &quot;, n), xlim = c(-1, 1))
plot(dens1000, main = paste0(&quot;n = &quot;, n), xlim = c(-1, 1))
plot(dens10000, main = paste0(&quot;n = &quot;, n), xlim = c(-1, 1))
plot(dens100000, main = paste0(&quot;n = &quot;, n), xlim = c(-1, 1))
```

\(c\) ¬øQu√© densidad dir√≠a que tiene X~med~?

**Respuesta:** Por las gr√°ficas, podemos ver que X~med~ tiene una distribuci√≥n Normal.

### Ejercicio 11

Considere X~1~, . . . , X~999~ variables aleatorias independientes e id√©nticamente distribuidas, X~i~ ‚àº Unif\[-1, 1\]. Tambi√©n considere X~1000~ ‚àº Unif\[200,300\], independiente de las otras 999 variables aleatorias, i.e. en total se tienen 1000 variables aleatorias independientes.

\(a\) Para n = 100, 1000, 10000, 100000 haga n\\ simulaciones para obtener la funci√≥n de masa de probabilidad aproximada de xÃÖ.

```{r}
var &lt;- 999  # 999 uniformes(-1,1) + 1 unif(200,300)
var2 &lt;- 1 
vector_unif &lt;- c()
vector_simuls &lt;- c()
xmed_arit &lt;- c()
## n = 100
n &lt;- 100
for(i in 1:n){  
  vector_unif &lt;- runif(var,min = -1, max = 1)
  unif2 &lt;- runif(var2,200,300)
  vector_unif &lt;- c(vector_unif, unif2)
  suma_variables &lt;- sum(vector_unif)
  med_arit &lt;- (1/(num_var + num_var2))*suma_variables
  xmed_arit[i] &lt;- med_arit
}
df &lt;- data.frame(media = xmed_arit)
grafica11_1 &lt;- df %&gt;% ggplot() + 
  geom_histogram(aes(x = media ,
                     y = after_stat(count)/sum(after_stat(count))),
                 size = 1, fill = &quot;#FF9900&quot;) + 
  ggtitle(&quot;Densidad con n = 100 simulaciones&quot;) +
  ylab(&quot;f(x)&quot;) + xlab(&quot;N&quot;) + theme_light()
## n = 1000
n &lt;- 1000
for(i in 1:n){  
  vector_unif &lt;- runif(var,min = -1, max = 1)
  unif2 &lt;- runif(var2,200,300)
  vector_unif &lt;- c(vector_unif, unif2)
  suma_variables &lt;- sum(vector_unif)
  med_arit &lt;- (1/(num_var + num_var2))*suma_variables
  xmed_arit[i] &lt;- med_arit
}
df &lt;- data.frame(media = xmed_arit)
grafica11_2 &lt;- df %&gt;% ggplot() + 
  geom_histogram(aes(x = media ,
                     y = after_stat(count)/sum(after_stat(count))),
                 size = 1, fill = &quot;#FF9933&quot;) + 
  ggtitle(&quot;Densidad con n = 1000 simulaciones&quot;) +
  ylab(&quot;f(x)&quot;) + xlab(&quot;N&quot;) + theme_light()
## n = 10000
n &lt;- 10000
for(i in 1:n){  
  vector_unif &lt;- runif(var,min = -1, max = 1)
  unif2 &lt;- runif(var2,200,300)
  vector_unif &lt;- c(vector_unif, unif2)
  suma_variables &lt;- sum(vector_unif)
  med_arit &lt;- (1/(num_var + num_var2))*suma_variables
  xmed_arit[i] &lt;- med_arit
}
df &lt;- data.frame(media = xmed_arit)
grafica11_3 &lt;- df %&gt;% ggplot() + 
  geom_histogram(aes(x = media ,
                     y = after_stat(count)/sum(after_stat(count))),
                 size = 1, fill = &quot;#CC6600&quot;) + 
  ggtitle(&quot;Densidad con n = 10000 simulaciones&quot;) +
  ylab(&quot;f(x)&quot;) + xlab(&quot;N&quot;) + theme_light()
## n = 100000
n &lt;- 100000
for(i in 1:n){  
  vector_unif &lt;- runif(var,min = -1, max = 1)
  unif2 &lt;- runif(var2,200,300)
  vector_unif &lt;- c(vector_unif, unif2)
  suma_variables &lt;- sum(vector_unif)
  med_arit &lt;- (1/(num_var + num_var2))*suma_variables
  xmed_arit[i] &lt;- med_arit
}
df &lt;- data.frame(media = xmed_arit)
grafica11_4 &lt;- df %&gt;% ggplot() + 
  geom_histogram(aes(x = media ,
                     y = after_stat(count)/sum(after_stat(count))),
                 size = 1, fill = &quot;#CC6633&quot;) + 
  ggtitle(&quot;Densidad con n = 100000 simulaciones&quot;) +
  ylab(&quot;f(x)&quot;) + xlab(&quot;N&quot;) + theme_light()
```

(b) Usando las funciones de las librer√≠a 'patchwork' ponga en un mismo gr√°fico las cuatro gr√°ficas de las funciones de masa del inciso (a).

```{r}
(grafica11_1 | grafica11_2) / (grafica11_3 | grafica11_4)
```

\(c\) ¬øQu√© densidad dir√≠a que tiene xÃÖ?

**Respuesta:** Con lo visto en las gr√°ficas, dir√≠amos que tienden a tener una distribuci√≥n Beta o Normal.

\(d\) ¬øDir√≠a que se violenta el Teorema del L√≠mite Central?

**Respuesta:** No, debido a que todas las variables cuentan tanto con medias como con varianzas finitas, por lo que se puede aplicvar el TLC de forma correcta. Adem√°s, en todos los casos, tenemos muestras con tama√±os mayores a 30.

### Ejercicio 12

Considere X~1~, . . . , X~n~ variables aleatorias independientes e id√©nticamente distribuidas, X~i~ ‚àº exp(1). Sea X~med~ el segundo valor mas de peque√±o de estas n X~i~'s

\(a\) Para n = 100, 1,000, 10,000, 100,000 haga 10000 simulaciones para obtener la funci√≥n de masa de probabilidad aproximada de X~med~.

```{r}
## n = 100
n &lt;- 100  
N &lt;- 10000  

med100 &lt;- replicate(N, median(rexp(n)))
dens100 &lt;- density(med100)

## n = 1000
n &lt;- 1000 
N &lt;- 10000

med1000 &lt;- replicate(N, median(rexp(n)))
dens1000 &lt;- density(med1000)

## n = 10000
n &lt;- 10000
N &lt;- 10000

med10000 &lt;- replicate(N, median(rexp(n)))
dens10000 &lt;- density(med10000)

## n = 100000
n &lt;- 100000 
N &lt;- 10000

med100000 &lt;- replicate(N, median(rexp(n)))
dens100000 &lt;- density(med100000)
```

\(b\) Usando las funciones de las librer√≠a 'patchwork' ponga en un mismo gr√°fico las cuatro gr√°ficas de las funciones de masa del inciso (a).

```{r}
par(mfrow = c(2, 2))
plot(dens100, main = paste0(&quot;n = &quot;, n), xlim = c(0, 4))
plot(dens1000, main = paste0(&quot;n = &quot;, n), xlim = c(0, 4))
plot(dens10000, main = paste0(&quot;n = &quot;, n), xlim = c(0, 4))
plot(dens100000, main = paste0(&quot;n = &quot;, n), xlim = c(0, 4))
```

\(c\) ¬øQu√© densidad dir√≠a que tiene X~med~?

**Respuesta:** Osbervando las gr√°ficas, y por el Teorema Central del L√≠mite, sabemos que X~med~ tiene una distribuci√≥n Exponencial.

### Ejercicio 13

Considere X~1~, . . . , X~n~ variables aleatorias independientes e id√©nticamente distribuidas, t(1).

\(a\) Calcule te√≥ricamente ùîº(X)

**Respuesta:** Ya que las variables se distribuyen de forma T de student con 1 grado de libertad, podemos decir que siguen una distribuci√≥n de Cauchy. De manera te√≥rica sabemos que la distribuci√≥n de Cauchy tiene tanto como un valor esperado como una varianza indefinida. Esto se puede comprobar con la Ley de los grandes n√∫meros.

\(b\) Para n = 100, 1,000, 10,000, 100,000 haga 10,000 simulaciones para obtener la funci√≥n de masa de probabilidad aproximada de xÃÖ, i.e. el promedio aritm√©tico de las observaciones.

```{r}
n_val &lt;- c(100, 1000, 10000, 100000)
n_sim &lt;- 10000

prom_t &lt;- function(n) {
  X &lt;- rt(n, df = 1)
  prom &lt;- mean(X)
  return(prom)
}

prom_nt &lt;- function(n) {
  sapply(1:n_sim, function(x) prom_t(n))
}

dens_t &lt;- lapply(n_values, function(n) {
  simulations &lt;- prom_nt(n)
  density(simulations)
})
grafica_t &lt;- function(pdf, n) {
  df &lt;- data.frame(x = pdf$x, y = pdf$y)
  p &lt;- ggplot(df, aes(x = x, y = y)) +
    geom_line() +
    labs(title = paste0(&quot;n = &quot;, n),
         x = &quot;¬ØX&quot;,
         y = &quot;Densidad&quot;)
  return(p)
}

grafica13 &lt;- mapply(grafica_t, dens_t, n_val, SIMPLIFY = FALSE)
```

(c) Usando las funciones de la librer√≠a 'patchwork' ponga en un mismo gr√°fico las cuatro gr√°ficas de las funciones de masa del inicio (a).

```{r}
(grafica13[[1]] | grafica13[[2]]) / (grafica13[[3]] | grafica13[[4]])
```

\(d\) ¬øQu√© densidad dir√≠a que tiene xÃÖ?

**Respuesta:** Dado que nuestras variables aleatorias cuentan una media indefinida y con una desviaci√≥n estandar tambi√©n indefinida, nuestra mejor aproximaci√≥n es sugerir que xÃÖ tiene distribuci√≥n t(1).

\(e\) ¬øDir√≠a que se violenta el Teorema del L√≠mite Central?

**Respuesta:** S√≠, dado que, como se coment√≥ en el inciso anterior, nuestra muestra no cuenta con medias ni con varianzas definidas, a pesar de que son muestras de tama√±os mayores a 30.

### Ejercicio 14

Responda las siguientes preguntas:

\(a\) Considere el lanzamiento de 2 dados y sea X la suma sus valores. Lleve a cabo 100,000 simulaciones y obtenga una aproximaci√≥n de la funci√≥n de masa de X.

```{r}
caras &lt;- 1:6
dados &lt;- 2
n &lt;- 100000
vector_simuls &lt;- c()

for(i in 1:n){
  simulacion &lt;- sample(x =caras, size = dados, replace= TRUE)
  valor_sim &lt;- sum(simulacion)
  vector_simuls &lt;- c(vector_simuls,valor_sim)
}
df &lt;- data.frame(suma = vector_simuls)

grafica14_1 &lt;- df %&gt;% ggplot() + 
  geom_histogram(aes(x = suma,
                     y = after_stat(count)/sum(after_stat(count))),
                 linewidth = 1, fill = &quot;#FF6600&quot;) + 
  ggtitle(&quot;Densidad de la suma con n = 100,000&quot;) +
  ylab(&quot;f(x)&quot;) + xlab(&quot;Suma&quot;) + theme_light()
grafica14_1
```

\(b\) Considere dos hexaedros, uno con todas las caras marcadas con &quot;5&quot;; el otro tiene 3 marcas de &quot;2&quot; y el resto de &quot;6&quot;. Simule el lanzamiento de estos dos dados y sea Y la suma de sus valores. Lleve a cabo 100,000 simulaciones y obtenga una aproximaci√≥n de la funci√≥n de masa de Y.

```{r}
hex1 &lt;- c(5,5,5,5,5,5)
hex2 &lt;- c(2,2,2,6,6,6)
n &lt;- 100000
vector_simuls &lt;- c()

for(i in 1:n){
  sim1 &lt;- sample(x = hex1, size = 1)
  sim2 &lt;- sample(x = hex2, size = 1)
  valor_sim &lt;- sim1 + sim2
  vector_simuls &lt;- c(vector_simuls,valor_sim)
}
df &lt;- data.frame(suma = vector_simuls)

grafica14_2 &lt;- df %&gt;% ggplot() + 
  geom_histogram(aes(x = suma,
                     y = after_stat(count)/sum(after_stat(count))),
                 linewidth = 1, fill = &quot;#CC0099&quot;) + 
  ggtitle(&quot;Densidad de la suma con n = 100,000&quot;) +
  ylab(&quot;f(x)&quot;) + xlab(&quot;Suma&quot;) + theme_light()
grafica14_2
```

\(c\) Considere el lanzamiento de dos hexaedros, uno marcado con las etiquetas &quot;1&quot;, &quot;2&quot;, &quot;2&quot;, &quot;3&quot;, &quot;3&quot;, &quot;4&quot; en cada cara; el otro tiene las etiquetas &quot;1&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot; y &quot;8&quot;. Sea Z la suma de sus valores. Lleve a cabo 100,000 simulaciones y obtenga una aproximaci√≥n de la funci√≥n de masa de Z.

```{r}
hex3 &lt;- c(1,2,2,3,3,4)
hex4 &lt;- c(1,3,4,5,6,8)
n &lt;- 100000
vector_simuls &lt;- c()

for(i in 1:n){
  sim3 &lt;- sample(x = hex3, size = 1)
  sim4 &lt;- sample(x = hex4, size = 1)
  valor_sim &lt;- sim3 + sim4
  vector_simuls &lt;- c(vector_simuls,valor_sim)
}
df &lt;- data.frame(suma = vector_simuls)

grafica14_3 &lt;- df %&gt;% ggplot() + 
  geom_histogram(aes(x = suma,
                     y = after_stat(count)/sum(after_stat(count))),
                 linewidth = 1, fill = &quot;#009966&quot;) + 
  ggtitle(&quot;Densidad de la suma con n = 100,000&quot;) +
  ylab(&quot;f(x)&quot;) + xlab(&quot;Suma&quot;) + theme_light()
grafica14_3
```

\(d\) ¬øQu√© puede decir de las densidades de X, Y y Z?

**Respuesta:** De acuerdo con lo que se puede ver en las gr√°ficas, tanto X como Z podr√≠an tener una distribuci√≥n Binomial, mientras que Y podr√≠a tener una distribuci√≥n Bernoulli.

**Con este √∫ltimo ejercicio, llegamos al fin de este sitio.**

Autores: Claire Valeria Calder√≥n Zavaleta y Young Woo Choi</pre>
</body>
</html>